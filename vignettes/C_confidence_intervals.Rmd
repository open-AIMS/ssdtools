---
title: "Distributions in ssdtools"
author: "ssdtools Team"
date: "`r Sys.Date()`"
bibliography: references.bib
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Selecting Distributions}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
library(ssdtools)
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.height = 4,
  fig.width = 6
)
```

## Bootstrap confidence intervals

Bootstrapping is a resampling technique used to obtain estimates of summary statistics.
The team have explored the use of alternative methods for obtaining the confidence interval of HC estimates.
This included using the closed-form expression for the variance-covariance matrix of the parameters
of the Burr III distribution, coupled with the delta-method, as well as an alternative bootstrap method
for the inverse Pareto distribution based on statistical properties of the parameters [@fox_methodologies_2021]. In both cases, it
appeared that these methods can give results similar to other traditional bootstrapping approaches
in much less time, and are therefore potentially worth further investigation. However,
implementation of such methods across all the distributions now available in ssdtools would be a
substantial undertaking.

The revised version of ssdtools retains the computationally intensive bootstrapping method to obtain confidence intervals and an estimate of standard errors. We recommend a minimum bootstrap sample of 1,000 (the current default - see argument nboot in ?ssd_hc). However, more reliable results can be obtained using samples of 5,000 or 10,000. We recommend larger bootstrap samples for final reporting.

## Parametric versus non-parametric bootstrapping

Burrlioz 2.0 uses a non-parametric bootstrap method to obtain confidence intervals on the HC
estimate. Non-parametric bootstrapping is carried out by repeatedly resampling the raw data with
replacement, and refitting the distribution many times. The 95% confidence limits are then obtained
by calculating the lower 0.025th and upper 0.975th quantiles of the resulting HC estimates across all56
the bootstrap samples (typically >1000). This type of bootstrap takes into account uncertainty in the
distribution fit based on uncertainty in the data.

The ssdtools package by default uses a parametric bootstrap. Instead of resampling the data,
parametric bootstrapping draws a random a set of new data (of the same sample size as the original)
from the fitted distribution to repeatedly refit the distribution. Upper and lower 95% bounds are again
calculated as the lower 0.025th and upper 0.975th quantiles of the resulting HC estimates across all the
bootstrap samples (again, typically >1000). This will capture the possible uncertainty that may occur
for a sample size from a given distribution, but it assumes no uncertainty in that original fit, so it is not
accounting for uncertainty in the input data.

The new TMB version of ssdtools has the capacity to do bootstrapping either using the Burrlioz
non-parametric method, or the original parametric method of ssdtools (based on
fitdistrplus [@fitdistrplus]).

Using simulation studies the ssdtools team examined bias and compared the resulting coverage
of the parametric and non-parametric bootstrapping methods [@fox_methodologies_2021]. They found that coverage was better using the parametric bootstrapping method, and this has been retained in the update to ssdtools. The non-parametric boostrapping method adopted by Burrlioz 2.0 is no longer used.


## Bootstrapping model averaged SSDs

Bootstrapping to obtain confidence intervals for individual fitted distributions is relatively straightforward. However, obtaining bootstrap confidence intervals for model averaged SSDs requires careful consideration, as the procedure is subject to the same pitfalls evident when obtaining model averaged *HCx* estimates. The [Model Average SSDs](https://poissonconsulting.github.io/ssdtools/articles/A_model_averaging.html) vignette contains a detailed explanation of the fallacy of weighting individual *HCx* values, and how this can lead to spurious results.

The revised version of ssdtools supports three weighting methods for obtaining bootstrap confidence intervals and an estimate of the standard error, and these are discussed in detail below.

### Weighted arithmetic mean 

The early versions of ssdtools provided estimated confidence intervals that were calculated as a weighted arithmetic mean of the CI and se values estimated as a quantile() and sd() from bootstrap (parametric or non-parametric) simulation from each of the individual candidate distributions (original, should not be used, kept for legacy reasons)

### Weighted mixture distribution

CI and se values estimated as a quantile() and sd() from bootstrap (parametric or non-parametric) simulation from a AICc weighted mixture distribution, with and without fixed weights (arguable technically correct, some philosophical issues to discuss, can be used, is slower)

### Weighted bootstrap sample 

CI and se values estimated as a quantile() and sd() from bootstrap (parametric or non-parametric) simulation from each of the individual candidate distributions, pooled across nboot in proportion to the AICc weights of each (arguable technically less correct, some philosophical issues to discuss, can be used, is faster, is default)


## References

<div id="refs"></div>

```{r, results = "asis", echo = FALSE}
cat(licensing_md())
```
