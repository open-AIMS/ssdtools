---
title: "Distributions in ssdtools"
author: "ssdtools Team"
date: "`r Sys.Date()`"
bibliography: references.bib
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Selecting Distributions}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
library(ssdtools)
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.height = 4,
  fig.width = 6
)
```

## Bootstrap confidence intervals

[Some basic information on bootstrapping and recommendations of the number of bootstrap samples that should be used]

## Parametric versus non-parametric bootstrapping

Burrlioz 2.0 uses a non-parametric bootstrap method to obtain confidence intervals on the HC
estimate. Non-parametric bootstrapping is carried out by repeatedly resampling the raw data with
replacement, and refitting the distribution many times. The 95% confidence limits are then obtained
by calculating the lower 0.025th and upper 0.975th quantiles of the resulting HC estimates across all56
the bootstrap samples (typically >1000). This type of bootstrap takes into account uncertainty in the
distribution fit based on uncertainty in the data.

The ssdtools package by default uses a parametric bootstrap. Instead of resampling the data,
parametric bootstrapping draws a random a set of new data (of the same sample size as the original)
from the fitted distribution to repeatedly refit the distribution. Upper and lower 95% bounds are again
calculated as the lower 0.025th and upper 0.975th quantiles of the resulting HC estimates across all the
bootstrap samples (again, typically >1000). This will capture the possible uncertainty that may occur
for a sample size from a given distribution, but it assumes no uncertainty in that original fit, so it is not
accounting for uncertainty in the input data.

The new TMB version of ssdtools has the capacity to do bootstrapping either using the Burrlioz
non-parametric method, or the original parametric method of ssdtools (based on
fitdistrplus).

Using simulation studies the ssdtools team examined bias and compared the resulting coverage
of the parametric and non-parametric bootstrapping methods [ref]. 



## Bootstrapping model averaged SSDs

[A description of the three parametric bootstrapping methods implemented in ssdtools, what they are doing and notes on if they should/should not be used.]

### Weighted arithmetic mean 

calcualted as a weighted arithmetic mean of the CI and se values estimated as a quantile() and sd() from bootstrap (parametric or non-parametric) simulation from each of the individual candidate distributions (original, should not be used, kept for legacy reasons)

### Weighted mixture distribution

CI and se values estimated as a quantile() and sd() from bootstrap (parametric or non-parametric) simulation from a AICc weighted mixture distribution, with and without fixed weights (arguable technically correct, some philosophical issues to discuss, can be used, is slower)

### Weighted bootstrap sample 

CI and se values estimated as a quantile() and sd() from bootstrap (parametric or non-parametric) simulation from each of the individual candidate distributions, pooled across nboot in proportion to the AICc weights of each (arguable technically less correct, some philosophical issues to discuss, can be used, is faster, is default)


## References

<div id="refs"></div>

```{r, results = "asis", echo = FALSE}
cat(licensing_md())
```
